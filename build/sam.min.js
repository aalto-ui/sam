!function(){return function e(t,s,i){function r(n,a){if(!s[n]){if(!t[n]){var l="function"==typeof require&&require;if(!a&&l)return l(n,!0);if(o)return o(n,!0);var c=new Error("Cannot find module '"+n+"'");throw c.code="MODULE_NOT_FOUND",c}var d=s[n]={exports:{}};t[n][0].call(d.exports,function(e){return r(t[n][1][e]||e)},d,d.exports,e,t,s,i)}return s[n].exports}for(var o="function"==typeof require&&require,n=0;n<i.length;n++)r(i[n]);return r}}()({1:[function(e,t,s){"use strict";Object.defineProperty(s,"__esModule",{value:!0});const i=e("./elements/MenuManager"),r=e("./elements/Menu"),o=e("./elements/ItemGroup"),n=e("./elements/Item"),a=e("./data/DataManager"),l=e("./adaptations/AdaptationManager"),c=e("./VisualControls");class d{constructor(e,t=!0){this.VERSION="1.0.0",this.menuManager=e,this.dataManager=new a.DataManager(this.menuManager),this.adaptationManager=new l.AdaptationManager(this.menuManager,this.dataManager),this.adaptationManager.applyCurrentAdaptation(),this.visualControls=new c.VisualControls(this,t)}clearHistory(){this.dataManager.database.empty(),this.adaptationManager.updateCurrentAdaptation()}addMenu(e){this.adaptationManager.cancelCurrentAdaptation(),this.menuManager.addMenu(e),this.dataManager.logger.startListeningForMenuItemClicks(e),this.adaptationManager.applyCurrentAdaptation()}removeMenu(e){this.adaptationManager.cancelCurrentAdaptation();let t=this.menuManager.removeMenu(e);null!==t&&this.dataManager.logger.stopListeningForMenuItemClicks(t[0]),this.adaptationManager.applyCurrentAdaptation()}static fromSelectors(e,t,s){if(void 0===t){let t=i.MenuManager.fromSpecificSelectors(e);return new d(t)}if(void 0===s){let s=i.MenuManager.fromGenericMenuAndItemSelectors(e,t);return new d(s)}{let r=i.MenuManager.fromGenericMenuGroupAndItemSelectors(e,t,s);return new d(r)}}static fromStandardClasses(){let e="."+r.Menu.HTML_CLASS,t="."+o.ItemGroup.HTML_CLASS,s="."+n.Item.HTML_CLASS,a=i.MenuManager.fromGenericMenuGroupAndItemSelectors($(e),$(t),$(s));return new d(a)}}s.SelfAdaptingMenus=d},{"./VisualControls":3,"./adaptations/AdaptationManager":4,"./data/DataManager":28,"./elements/Item":33,"./elements/ItemGroup":34,"./elements/Menu":35,"./elements/MenuManager":36}],2:[function(e,t,s){"use strict";Object.defineProperty(s,"__esModule",{value:!0});class i{static getCurrentPageID(){return window.location.hostname.concat(window.location.pathname)}static getLinkedPageID(e){let t=document.createElement("a");return t.href=e,t.hostname.concat(t.pathname)}static isLinkMatchingPageID(e,t){return i.getLinkedPageID(e)===t}static isLocalStorageAvailable(){return!!window.localStorage||(console.error("Error: local storage is not available!"),!1)}}s.Utilities=i},{}],3:[function(e,t,s){(function(t){"use strict";Object.defineProperty(s,"__esModule",{value:!0});const i="undefined"!=typeof window?window.jQuery:void 0!==t?t.jQuery:null,r=e("./adaptations/AdaptationManager");s.VisualControls=class{constructor(e,t=!0){this.sam=e,this.controlsContainerNode=null,t&&this.show()}updateAdaptationStyle(){let e=i("#sam-gui-switch-style-menu").val();this.sam.adaptationManager.switchToStyle(e)}updateTargetPolicy(){let e=i("#sam-gui-switch-policy-menu").val();this.sam.adaptationManager.switchToPolicy(e)}addControlContainerNode(){let e=i("<div>").attr("id","sam-gui-controls-container");i("body").prepend(e),this.controlsContainerNode=e}addStyleListNode(){this.controlsContainerNode.append(i("<label>").attr("for","sam-gui-switch-style-menu").html("Style:")),this.controlsContainerNode.append(i("<select>").attr("id","sam-gui-switch-style-menu").on("change",e=>{this.updateAdaptationStyle()}));for(let e of r.AVAILABLE_STYLE_NAMES){let t=i("<option>").attr("val",e).html(e);e===this.sam.adaptationManager.getCurrentStyleName()&&t.prop("selected",!0),i("#sam-gui-switch-style-menu").append(t)}}addPolicyListNode(){this.controlsContainerNode.append(i("<label>").attr("for","sam-gui-switch-policy-menu").html("Policy:")),this.controlsContainerNode.append(i("<select>").attr("id","sam-gui-switch-policy-menu").on("change",e=>{this.updateTargetPolicy()}));for(let e of r.AVAILABLE_POLICY_NAMES){let t=i("<option>").attr("val",e).html(e);e===this.sam.adaptationManager.getCurrentPolicyName()&&t.prop("selected",!0),i("#sam-gui-switch-policy-menu").append(t)}}addClearHistoryButtonNode(){this.controlsContainerNode.append(i("<button>").html("Clear history (require page reloading)").attr("id","sam-gui-clear-history-button").on("click",()=>{this.sam.clearHistory()}))}addAllControls(){this.addControlContainerNode(),this.addStyleListNode(),this.addPolicyListNode(),this.addClearHistoryButtonNode()}removeAllControls(){this.controlsContainerNode.remove(),this.controlsContainerNode=null}show(){this.display=!0,this.addAllControls()}hide(){this.display=!1,this.removeAllControls()}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./adaptations/AdaptationManager":4}],4:[function(e,t,s){"use strict";Object.defineProperty(s,"__esModule",{value:!0});const i=e("./styles/Highlight"),r=e("./styles/Identity"),o=e("./styles/ReorderItems"),n=e("./styles/composites/HighlightAndReorderItems"),a=e("./styles/Fold"),l=e("./styles/composites/ReorderItemsAndFold"),c=e("./styles/composites/HighlightReorderItemsAndFold"),d=e("./styles/ReorderGroups"),u=e("./styles/composites/HighlightAndReorderAll"),h=e("./styles/composites/ProgressiveHighlightAndReorderItems"),p=e("./policies/AccessRankPolicy"),g=e("./policies/LongestVisitDurationPolicy"),m=e("./policies/MostClickedItemsPolicy"),y=e("./policies/MostRecentVisitsPolicy"),f=e("./policies/MostVisitedPagesPolicy"),S=e("./policies/SerialPositionCurvePolicy");s.AVAILABLE_STYLES=[new r.Identity,new i.Highlight,new o.ReorderItems,new n.HighlightAndReorderItems,new a.Fold,new l.ReorderItemsAndFold,new c.HighlightReorderItemsAndFold,new d.ReorderGroups,new u.HighlightAndReorderAll,new h.ProgressiveHighlightAndReorderItems],s.AVAILABLE_STYLE_NAMES=s.AVAILABLE_STYLES.map(e=>e.name),s.AVAILABLE_POLICIES=[new m.MostClickedItemsPolicy,new f.MostVisitedPagesPolicy,new y.MostRecentVisitsPolicy,new g.LongestVisitDurationPolicy,new S.SerialPositionCurvePolicy,new p.AccessRankPolicy],s.AVAILABLE_POLICY_NAMES=s.AVAILABLE_POLICIES.map(e=>e.name);s.AdaptationManager=class{constructor(e,t){this.menuManager=e,this.dataManager=t,this.currentStyle=null,this.currentPolicy=null,this.restoreAdaptationFromDatabaseOrSetDefault()}getCurrentStyleName(){return this.currentStyle.name}setStyle(e){let t=s.AVAILABLE_STYLES.find(t=>t.name===e);void 0!==t?(this.currentStyle=t,console.log(`Style has been set to ${e}.`),this.dataManager.database.persistentStorage.styleName=e):console.error(`Style with name ${e} does not exist.`)}setDefaultStyle(){this.setStyle("Highlight + reorder items")}restoreStyleFromDatabaseOrSetDefault(){let e=this.dataManager.database.persistentStorage.styleName;void 0!==e?this.setStyle(e):this.setDefaultStyle()}switchToStyle(e){this.cancelCurrentAdaptation(),this.setStyle(e),this.applyCurrentAdaptation()}getCurrentPolicyName(){return this.currentPolicy.name}setPolicy(e){let t=s.AVAILABLE_POLICIES.find(t=>t.name===e);void 0!==t?(this.currentPolicy=t,console.log(`Policy has been set to ${e}.`),this.dataManager.database.persistentStorage.policyName=e):console.error(`Policy with name ${e} does not exist.`)}setDefaultPolicy(){this.setPolicy("AccessRank")}restorePolicyFromDatabaseOrSetDefault(){let e=this.dataManager.database.persistentStorage.policyName;void 0!==e?this.setPolicy(e):this.setDefaultPolicy()}switchToPolicy(e){this.cancelCurrentAdaptation(),this.setPolicy(e),this.applyCurrentAdaptation()}restoreAdaptationFromDatabaseOrSetDefault(){this.restoreStyleFromDatabaseOrSetDefault(),this.restorePolicyFromDatabaseOrSetDefault()}applyCurrentAdaptation(){this.currentStyle.apply(this.menuManager,this.currentPolicy,this.dataManager),console.log(`Applying style ${this.currentStyle.name} with policy ${this.currentPolicy.name}.`)}cancelCurrentAdaptation(){this.currentStyle.cancel()}updateCurrentAdaptation(){this.cancelCurrentAdaptation(),this.applyCurrentAdaptation()}switchToAdaptation(e,t){this.cancelCurrentAdaptation(),this.setStyle(e),this.setPolicy(t),this.applyCurrentAdaptation()}}},{"./policies/AccessRankPolicy":5,"./policies/LongestVisitDurationPolicy":8,"./policies/MostClickedItemsPolicy":9,"./policies/MostRecentVisitsPolicy":10,"./policies/MostVisitedPagesPolicy":11,"./policies/SerialPositionCurvePolicy":13,"./styles/Fold":14,"./styles/Highlight":15,"./styles/Identity":16,"./styles/ReorderGroups":18,"./styles/ReorderItems":19,"./styles/composites/HighlightAndReorderAll":20,"./styles/composites/HighlightAndReorderItems":21,"./styles/composites/HighlightReorderItemsAndFold":22,"./styles/composites/ProgressiveHighlightAndReorderItems":23,"./styles/composites/ReorderItemsAndFold":24}],5:[function(e,t,s){"use strict";Object.defineProperty(s,"__esModule",{value:!0});const i=e("./DefaultTargetPolicy"),r=e("../../data/ItemClicksAnalyser");s.AccessRankPolicy=class extends i.DefaultTargetPolicy{constructor(){super(),this.name="AccessRank"}computeMarkovScores(e,t){let s=new Map;for(let i of e){let e=i.id,r=(t.itemStats.get(e).localNbClicks+1)/(t.totalLocalNbClicks+1);s.set(i,r)}return s}computeCRFScores(e,t){let s=t.currentEventIndex,i=new Map;for(let r of e){let e=r.id;const o=2,n=.1;let a=0;for(let i of t.itemStats.get(e).eventIndices)a+=Math.pow(1/o,n*(s-i));i.set(r,a)}return i}computeRegularityScores(e,t){let s=new Map,i=new Map;for(let r of e){let e=r.id,o=t.itemStats.get(e).timestamps,n=new Array(24).fill(0),a=new Array(7).fill(0);for(let e of o)n[new Date(e).getHours()]+=1,a[new Date(e).getDay()-1]+=1;s.set(r,n),i.set(r,a)}let r=new Map;for(let o of e){let e=o.id,n=1,a=1;if(t.itemStats.get(e).nbClicks>10){let e=(new Date).getHours(),t=0===e?23:e-1,r=23===e?23:0,l=s.get(o),c=l[t]+l[e]+l[r],d=0;for(let e=0;e<24;e++)d+=l[0===e?23:e-1]+l[e]+l[23===e?0:e+1];d/=24;let u=(new Date).getDay(),h=i.get(o),p=h[u-1],g=0;for(let e of h)g+=e;n=c/d,a=p/(g/=7)}let l=Math.pow(Math.max(.8,Math.min(1.25,n*a)),.25);r.set(o,l)}return r}getSortedItemsWithScores(e,t){let s=t.analyser.getItemClickAnalysis(),i=e.getAllItems(),o=r.ItemClicksAnalyser.splitItemsByStatsAvailability(i,s),n=o.withStats,a=o.withoutStats,l=this.computeMarkovScores(n,s),c=this.computeCRFScores(n,s),d=this.computeRegularityScores(n,s),u=new Map;for(let e of n){let t=l.get(e),s=c.get(e),i=d.get(e),r=Math.pow(t,1)*Math.pow(s,1)*i;u.set(e,r)}let h=[...u.entries()].sort((e,t)=>t[1]-e[1]).map(e=>({item:e[0],score:e[1]})),p=a.map(e=>({item:e,score:0}));return h.concat(p)}}},{"../../data/ItemClicksAnalyser":30,"./DefaultTargetPolicy":6}],6:[function(e,t,s){"use strict";Object.defineProperty(s,"__esModule",{value:!0});s.DefaultTargetPolicy=class{getSortedItems(e,t){return this.getSortedItemsWithScores(e,t).map(e=>e.item)}getSortedItemGroupsWithScores(e,t){let s=new Map,i=0,r=this.getSortedItemsWithScores(e,t);for(let e of r){let t=e.score,r=e.item.parent;if(s.has(r)){let e=s.get(r);s.set(r,e+t)}else s.set(r,t);i+=t}return[...s.entries()].sort((e,t)=>t[1]-e[1]).map(e=>({group:e[0],score:e[1]/i}))}getSortedItemGroups(e,t){return this.getSortedItemGroupsWithScores(e,t).map(e=>e.group)}}},{}],7:[function(e,t,s){"use strict";Object.defineProperty(s,"__esModule",{value:!0});const i=e("./DefaultTargetPolicy");s.LinkedPageScorePolicy=class extends i.DefaultTargetPolicy{constructor(){super(),this.pageScores=new Map,this.itemScores=new Map,this.pageVisitsAnalysis=null}computeAndSetPageScores(){this.pageScores.clear();for(let e of this.pageVisitsAnalysis.pageStats.keys()){let t=this.computePageScore(e);this.pageScores.set(e,t)}}computeAndSetItemScores(e){this.itemScores.clear();for(let t of e){let e=0;for(let s of this.pageScores.keys())if(t.findLinkNodes(s).length>0){e=this.pageScores.get(s);break}this.itemScores.set(t,e)}}getSortedItemsWithScores(e,t){let s=e.getAllItems();return this.pageVisitsAnalysis=t.analyser.getPageVisitsAnalysis(),this.computeAndSetPageScores(),this.computeAndSetItemScores(s),[...this.itemScores.entries()].map(([e,t])=>({item:e,score:t})).sort((e,t)=>t.score-e.score)}}},{"./DefaultTargetPolicy":6}],8:[function(e,t,s){"use strict";Object.defineProperty(s,"__esModule",{value:!0});const i=e("./LinkedPageScorePolicy");s.LongestVisitDurationPolicy=class extends i.LinkedPageScorePolicy{constructor(){super(),this.name="Longest visit duration"}computePageScore(e){return this.pageVisitsAnalysis.pageStats.get(e).totalVisitDuration}}},{"./LinkedPageScorePolicy":7}],9:[function(e,t,s){"use strict";Object.defineProperty(s,"__esModule",{value:!0});const i=e("./DefaultTargetPolicy"),r=e("../../data/ItemClicksAnalyser");s.MostClickedItemsPolicy=class extends i.DefaultTargetPolicy{constructor(){super(),this.name="Most clicked items",this.onlyLocalClicks=!1}sortMappedElementsByNbClicks(e){return[...e.entries()].map(e=>({element:e[0],nbClicks:e[1]})).sort((e,t)=>t.nbClicks-e.nbClicks)}getItemNbClicks(e,t){let s=t.itemStats.get(e.id);return this.onlyLocalClicks?s.localNbClicks:s.nbClicks}mapItemsToNbClicks(e,t){let s=new Map;for(let i of e){let e=this.getItemNbClicks(i,t);s.set(i,e)}return s}getSortedItemsWithScores(e,t){let s=t.analyser.getItemClickAnalysis(),i=e.getAllItems(),o=r.ItemClicksAnalyser.splitItemsByStatsAvailability(i,s),n=this.mapItemsToNbClicks(o.withStats,s),a=this.sortMappedElementsByNbClicks(n),l=this.onlyLocalClicks?s.totalLocalNbClicks:s.totalNbClicks,c=a.map(e=>({item:e.element,score:e.nbClicks/l})),d=o.withoutStats.map(e=>({item:e,score:0}));return c.concat(d)}getGroupNbClicks(e,t){let s=t.groupStats.get(e.id);return this.onlyLocalClicks?s.localNbClicks:s.nbClicks}mapGroupsToNbClicks(e,t){let s=new Map;for(let i of e){let e=this.getGroupNbClicks(i,t);s.set(i,e)}return s}getSortedItemGroupsWithScores(e,t){let s=t.analyser.getItemClickAnalysis(),i=e.getAllGroups(),o=r.ItemClicksAnalyser.splitItemGroupsByStatsAvailability(i,s),n=this.mapGroupsToNbClicks(o.withStats,s),a=this.sortMappedElementsByNbClicks(n),l=this.onlyLocalClicks?s.totalLocalNbClicks:s.totalNbClicks,c=a.map(e=>({group:e.element,score:e.nbClicks/l})),d=o.withoutStats.map(e=>({group:e,score:0}));return c.concat(d)}}},{"../../data/ItemClicksAnalyser":30,"./DefaultTargetPolicy":6}],10:[function(e,t,s){"use strict";Object.defineProperty(s,"__esModule",{value:!0});const i=e("./LinkedPageScorePolicy");s.MostRecentVisitsPolicy=class extends i.LinkedPageScorePolicy{constructor(){super(),this.name="Most recently visited"}computePageScore(e){return this.pageVisitsAnalysis.pageStats.get(e).lastVisitTimestamp}}},{"./LinkedPageScorePolicy":7}],11:[function(e,t,s){"use strict";Object.defineProperty(s,"__esModule",{value:!0});const i=e("./LinkedPageScorePolicy");s.MostVisitedPagesPolicy=class extends i.LinkedPageScorePolicy{constructor(){super(),this.name="Most visited pages"}computePageScore(e){return this.pageVisitsAnalysis.pageStats.get(e).nbVisits}}},{"./LinkedPageScorePolicy":7}],12:[function(e,t,s){"use strict";Object.defineProperty(s,"__esModule",{value:!0});const i=e("./DefaultTargetPolicy");s.NodeIndexOrderPolicy=class extends i.DefaultTargetPolicy{constructor(){super(),this.name="Node index order"}getSortedItemsWithScores(e){let t=e.getAllItems(),s=1/t.length;return t.sort((e,t)=>e.node.index()-t.node.index()).map(e=>({item:e,score:s}))}getSortedItemGroupsWithScores(e){let t=e.getAllGroups(),s=1/t.length;return t.sort((e,t)=>e.node.index()-t.node.index()).map(e=>({group:e,score:s}))}}},{"./DefaultTargetPolicy":6}],13:[function(e,t,s){"use strict";Object.defineProperty(s,"__esModule",{value:!0});const i=e("./LinkedPageScorePolicy");s.SerialPositionCurvePolicy=class extends i.LinkedPageScorePolicy{constructor(){super(),this.name="Serial-Position curve"}computeFamiliarityScore(e){if(!this.pageVisitsAnalysis.pageStats.has(e))return 0;let t=this.pageVisitsAnalysis.pageStats.get(e),s=0,i=0,r=t.lastVisitTimestamp,o=t.firstVisitTimestamp;for(let e of this.pageVisitsAnalysis.pageStats.values())e.lastVisitTimestamp>r&&s++,e.firstVisitTimestamp<o&&i++;return.4*t.visitFrequency+(this.pageVisitsAnalysis.nbUniquePages-s)/this.pageVisitsAnalysis.nbUniquePages*.4+(this.pageVisitsAnalysis.nbUniquePages-i)/this.pageVisitsAnalysis.nbUniquePages*.2}computePageScore(e){return this.computeFamiliarityScore(e)}}},{"./LinkedPageScorePolicy":7}],14:[function(e,t,s){(function(t){"use strict";Object.defineProperty(s,"__esModule",{value:!0});const i="undefined"!=typeof window?window.jQuery:void 0!==t?t.jQuery:null,r=e("../../elements/Item");class o{constructor(){this.name="Fold",this.folderNodes=[]}unfold(e){e.removeClass(o.IS_FOLDED_CLASS),e.find("."+o.SWITCH_FOLD_BUTTON_CLASS).html("Show less")}fold(e){e.addClass(o.IS_FOLDED_CLASS),e.find("."+o.SWITCH_FOLD_BUTTON_CLASS).html("Show more")}switchFoldState(e){e.hasClass(o.IS_FOLDED_CLASS)?this.unfold(e):this.fold(e)}createSwitchFoldButton(e){let t=i("<button>").addClass(o.SWITCH_FOLD_BUTTON_CLASS).attr("type","button");return t.on("click",()=>{this.switchFoldState(e)}),t}createAndAppendFoldButtonToFolder(e){let t=this.createSwitchFoldButton(e);e.find("."+o.FOLDABLE_ELEMENT_CLASS).last().after(t)}makeFolder(e){for(let t of e)t.node.addClass(o.FOLDABLE_ELEMENT_CLASS);let t=e[0].parent.node;t.addClass(o.FOLDER_ELEMENT_CLASS),this.folderNodes.push(t),this.createAndAppendFoldButtonToFolder(t),this.fold(t)}getMaxNbItemsToDisplayInGroup(e){return Math.ceil(Math.sqrt(e))}splitAndApplyByGroup(e){let t=r.Item.splitAllByGroup(e);for(let e of t)this.applyInGroup(e)}applyInGroup(e){let t=e[0].parent.items.length,s=this.getMaxNbItemsToDisplayInGroup(t);e.splice(0,s),this.makeFolder(e)}apply(e,t,s){let i=t.getSortedItems(e,s);this.splitAndApplyByGroup(i)}cancel(){for(let e of this.folderNodes)e.find("."+o.FOLDABLE_ELEMENT_CLASS).removeClass(o.FOLDER_ELEMENT_CLASS),e.find("."+o.SWITCH_FOLD_BUTTON_CLASS).remove(),e.removeClass(o.FOLDER_ELEMENT_CLASS);this.folderNodes=[]}}o.IS_FOLDED_CLASS="sam-folded",o.SWITCH_FOLD_BUTTON_CLASS="sam-fold-button",o.FOLDABLE_ELEMENT_CLASS="sam-foldable",o.FOLDER_ELEMENT_CLASS="sam-folder",s.Fold=o}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../../elements/Item":33}],15:[function(e,t,s){(function(t){"use strict";Object.defineProperty(s,"__esModule",{value:!0});const i="undefined"!=typeof window?window.jQuery:void 0!==t?t.jQuery:null,r=e("../../elements/Item");var o;!function(e){e.High="sam-high",e.Low="sam-low"}(o||(o={}));const n=Object.keys(o).map(e=>o[e]);class a{constructor(){this.name="Highlight",this.itemsToHighlightAtHighLevel=new Set}onNode(e,t){e.addClass([a.HIGHLIGHTED_ELEMENT_CLASS,t])}onAllItems(e){for(let t of e){let e=this.itemsToHighlightAtHighLevel.has(t)?o.High:o.Low;this.onNode(t.node,e)}}getFilteredSortedItemWithScores(e,t,s){return t.getSortedItemsWithScores(e,s).filter(e=>e.score>0)}getMaxNbItemsToHighlight(e){return Math.floor(Math.sqrt(e))}getMaxNbItemsToHighlightInGroup(e){return Math.floor(Math.sqrt(e))}computeItemsToHighlightAtHighLevel(e){this.itemsToHighlightAtHighLevel.clear();for(let t=0;t<Math.min(2,e.length);t++){let s=e[t];0!==s.score&&this.itemsToHighlightAtHighLevel.add(s.item)}}applyInGroup(e){let t=e[0].parent.items.length,s=this.getMaxNbItemsToHighlightInGroup(t),i=e.splice(0,s);this.onAllItems(i)}splitAndApplyByGroup(e){let t=r.Item.splitAllByGroup(e);for(let e of t)this.applyInGroup(e)}apply(e,t,s){let i=this.getFilteredSortedItemWithScores(e,t,s),r=e.getNbItems(),o=this.getMaxNbItemsToHighlight(r),n=i.slice(0,o),a=n.map(e=>e.item);this.computeItemsToHighlightAtHighLevel(n),this.splitAndApplyByGroup(a)}cancel(){let e=n;e.push(a.HIGHLIGHTED_ELEMENT_CLASS),i("."+a.HIGHLIGHTED_ELEMENT_CLASS).removeClass(e),this.itemsToHighlightAtHighLevel.clear()}}a.HIGHLIGHTED_ELEMENT_CLASS="sam-highlighted",s.Highlight=a}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../../elements/Item":33}],16:[function(e,t,s){"use strict";Object.defineProperty(s,"__esModule",{value:!0});s.Identity=class{constructor(){this.name="Identity"}cancel(){}apply(){}}},{}],17:[function(e,t,s){(function(t){"use strict";Object.defineProperty(s,"__esModule",{value:!0});const i="undefined"!=typeof window?window.jQuery:void 0!==t?t.jQuery:null,r=e("../../elements/AdaptiveElement");class o{constructor(){this.childrenInOriginalOrder=new Map,this.nonReorderableElementsInitialIndices=new Map}getReorderedElementClass(){return"sam-reordered"}splitNodesByParents(e){let t=new Map;for(let s of e){let e=s.parent().get(0);t.has(e)?t.get(e).push(s):t.set(e,[s])}return t}insertNode(e,t){t!==e.index()&&(0===t?e.parent().prepend(e):e.parent().children().eq(t-1).after(e))}moveReorderableNode(e,t){this.insertNode(e,t),e.addClass(this.getReorderedElementClass())}reinsertNonReorderableElements(){for(let e of this.nonReorderableElementsInitialIndices.keys()){let t=this.nonReorderableElementsInitialIndices.get(e);this.insertNode(i(e),t)}}saveNonReorderableElementsOriginalIndices(e){e.children("."+o.NON_REORDERABLE_ELEMENT_CLASS).each((e,t)=>{let s=i(t).index();this.nonReorderableElementsInitialIndices.set(t,s)})}saveParentNodeChildrenInOriginalOrder(e){for(let t of e){let e=t.node.parent()[0];this.childrenInOriginalOrder.has(e)||this.childrenInOriginalOrder.set(e,i(e).children())}}getSortedChildrenIndices(e){let t=this.getReorderedElementType();return e.children(`[${r.AdaptiveElement.TAG_PREFIX}type=${t}]`).get().map(e=>i(e).index()).sort((e,t)=>e-t)}reorderAllElements(e){let t=e.map(e=>e.node),s=this.splitNodesByParents(t);for(let e of s.keys()){let t=i(e),r=s.get(e);this.saveNonReorderableElementsOriginalIndices(t);let o=this.getSortedChildrenIndices(t);r.forEach((e,t)=>{this.moveReorderableNode(e,o[t])})}this.reinsertNonReorderableElements()}cancel(){for(let[e,t]of this.childrenInOriginalOrder.entries()){let s=i(e);t.each((e,t)=>{s.append(t)})}this.childrenInOriginalOrder.clear();let e=this.getReorderedElementClass();i("."+e).removeClass(e),this.nonReorderableElementsInitialIndices.clear()}}o.NON_REORDERABLE_ELEMENT_CLASS="sam-no-reordering",s.Reorder=o}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../../elements/AdaptiveElement":32}],18:[function(e,t,s){"use strict";Object.defineProperty(s,"__esModule",{value:!0});const i=e("./Reorder"),r=e("../../elements/ItemGroup");class o extends i.Reorder{constructor(){super(),this.name="Reorder groups"}getReorderedElementClass(){return"sam-reordered-group"}getReorderedElementType(){return r.ItemGroup.ELEMENT_TYPE}getFilteredSortedGroups(e,t,s){return t.getSortedItemGroupsWithScores(e,s).filter(e=>!!e.group.canBeReordered&&e.score>0).map(e=>e.group)}apply(e,t,s){let i=this.getFilteredSortedGroups(e,t,s);this.saveParentNodeChildrenInOriginalOrder(i),this.reorderAllElements(i)}}o.REORDERED_ELEMENT_CLASS="sam-reordered-group",s.ReorderGroups=o},{"../../elements/ItemGroup":34,"./Reorder":17}],19:[function(e,t,s){"use strict";Object.defineProperty(s,"__esModule",{value:!0});const i=e("./Reorder"),r=e("../../elements/Item");class o extends i.Reorder{constructor(){super(),this.name="Reorder items"}getReorderedElementClass(){return"sam-reordered-item"}getReorderedElementType(){return r.Item.ELEMENT_TYPE}getFilteredSortedItems(e,t,s){return t.getSortedItemsWithScores(e,s).filter(e=>!!e.item.canBeReordered&&e.score>0).map(e=>e.item)}getMaxNbItemsToReorder(e){return Math.floor(Math.sqrt(e))}getMaxNbItemsToReorderInGroup(e){return Math.floor(Math.sqrt(e))}applyInGroup(e){let t=e[0].parent.items.length,s=this.getMaxNbItemsToReorderInGroup(t),i=e.splice(0,s);this.reorderAllElements(i)}splitAndApplyByGroup(e){let t=r.Item.splitAllByGroup(e);for(let e of t)this.applyInGroup(e)}apply(e,t,s){let i=this.getFilteredSortedItems(e,t,s);this.saveParentNodeChildrenInOriginalOrder(i);let r=e.getNbItems(),o=this.getMaxNbItemsToReorder(r),n=i.slice(0,o);this.splitAndApplyByGroup(n)}}o.REORDERED_ELEMENT_CLASS="sam-reordered-item",s.ReorderItems=o},{"../../elements/Item":33,"./Reorder":17}],20:[function(e,t,s){"use strict";Object.defineProperty(s,"__esModule",{value:!0});const i=e("../ReorderItems"),r=e("./../ReorderGroups"),o=e("../Highlight");s.HighlightAndReorderAll=class{constructor(){this.name="Highlight + reorder items & groups",this.highlight=new o.Highlight,this.reorderItems=new i.ReorderItems,this.reorderGroups=new r.ReorderGroups}cancel(){this.reorderGroups.cancel(),this.reorderItems.cancel(),this.highlight.cancel()}apply(e,t,s){this.highlight.apply(e,t,s),this.reorderItems.apply(e,t,s),this.reorderGroups.apply(e,t,s)}}},{"../Highlight":15,"../ReorderItems":19,"./../ReorderGroups":18}],21:[function(e,t,s){"use strict";Object.defineProperty(s,"__esModule",{value:!0});const i=e("../Highlight"),r=e("../ReorderItems");s.HighlightAndReorderItems=class{constructor(){this.name="Highlight + reorder items",this.highlight=new i.Highlight,this.reorder=new r.ReorderItems}cancel(){this.reorder.cancel(),this.highlight.cancel()}apply(e,t,s){this.highlight.apply(e,t,s),this.reorder.apply(e,t,s)}}},{"../Highlight":15,"../ReorderItems":19}],22:[function(e,t,s){"use strict";Object.defineProperty(s,"__esModule",{value:!0});const i=e("../Highlight"),r=e("../ReorderItems"),o=e("../Fold"),n=e("../../policies/NodeIndexOrderPolicy");s.HighlightReorderItemsAndFold=class{constructor(){this.name="Highlight + reorder + fold",this.highlight=new i.Highlight,this.reorder=new r.ReorderItems,this.fold=new o.Fold,this.nodeIndexOrderPolicy=new n.NodeIndexOrderPolicy}cancel(){this.fold.cancel(),this.reorder.cancel(),this.highlight.cancel()}apply(e,t,s){this.highlight.apply(e,t,s),this.reorder.apply(e,t,s),this.fold.apply(e,this.nodeIndexOrderPolicy)}}},{"../../policies/NodeIndexOrderPolicy":12,"../Fold":14,"../Highlight":15,"../ReorderItems":19}],23:[function(e,t,s){"use strict";Object.defineProperty(s,"__esModule",{value:!0});const i=e("../Highlight"),r=e("../ReorderItems"),o=e("../../policies/AccessRankPolicy");s.ProgressiveHighlightAndReorderItems=class{constructor(){this.name="Progressive HL + R items",this.policy=new o.AccessRankPolicy,this.allItems=null,this.previousItemCharacteristics=null,this.currentItemCharacteristics=null,this.progressiveHighlight=this.createProgressiveHighlight(),this.progressiveReorder=this.createProgressiveReorderItem()}getItemsWithCurrentState(e){let t=Object.keys(this.currentItemCharacteristics).filter(t=>this.currentItemCharacteristics[t].state===e);return this.allItems.filter(e=>void 0!==t.find(t=>e.id===t))}createProgressiveHighlight(){let e=this;return new class extends i.Highlight{constructor(){super()}apply(){let t=e.getItemsWithCurrentState(2).concat(e.getItemsWithCurrentState(3)),s=t.concat(e.getItemsWithCurrentState(1));this.itemsToHighlightAtHighLevel=new Set(t),this.onAllItems(s)}}}createProgressiveReorderItem(){let e=this;return new class extends r.ReorderItems{constructor(){super()}apply(){let t=e.getItemsWithCurrentState(3).sort((t,s)=>e.currentItemCharacteristics[s.id].score-e.currentItemCharacteristics[t.id].score);this.reorderAllElements(t)}}}loadOrInitPreviousItemCharactertics(e,t){this.previousItemCharacteristics=t.persistentStorage.previousItemCharacteristics,void 0===this.previousItemCharacteristics&&(this.previousItemCharacteristics={});for(let t of e){let e=t.id;e in this.previousItemCharacteristics||(this.previousItemCharacteristics[e]={state:0,score:0,lastStateChangeScore:0})}}saveCurrentItemCharacteristics(e){e.persistentStorage.previousItemCharacteristics=JSON.parse(JSON.stringify(this.currentItemCharacteristics))}computeItemAdaptationState(e,t,s,i){let r=s-i;if(Math.abs(r)<.1)return e;switch(e){case 0:return s>.1?1:0;case 1:return r>.3?2:r<-.2?0:1;case 2:return r>.3?3:r<-.2?1:2;case 3:return r<-.4?2:3}}computeCurrentItemCharacteristics(e){let t={};for(let s of e){let e=s.item.id,i=this.previousItemCharacteristics[e].score,r=this.previousItemCharacteristics[e].lastStateChangeScore,o=s.score,n=this.previousItemCharacteristics[e].state,a=this.computeItemAdaptationState(n,i,o,r);t[e]={state:a,score:o,lastStateChangeScore:n===a?this.previousItemCharacteristics[e].lastStateChangeScore:o}}this.currentItemCharacteristics=t}cancel(){this.progressiveReorder.cancel(),this.progressiveHighlight.cancel(),this.allItems=null,this.previousItemCharacteristics=null,this.currentItemCharacteristics=null}apply(e,t,s){let i=e.getAllItems(),r=this.policy.getSortedItemsWithScores(e,s);this.allItems=i,this.loadOrInitPreviousItemCharactertics(i,s.database),this.computeCurrentItemCharacteristics(r),this.saveCurrentItemCharacteristics(s.database),console.log("Current characterstics",this.currentItemCharacteristics),this.progressiveHighlight.apply(null,null),this.progressiveReorder.apply(null,null)}}},{"../../policies/AccessRankPolicy":5,"../Highlight":15,"../ReorderItems":19}],24:[function(e,t,s){"use strict";Object.defineProperty(s,"__esModule",{value:!0});const i=e("../ReorderItems"),r=e("../Fold"),o=e("../../policies/NodeIndexOrderPolicy");s.ReorderItemsAndFold=class{constructor(){this.name="Reorder items + fold",this.reorder=new i.ReorderItems,this.fold=new r.Fold,this.naturalOrderPolicy=new o.NodeIndexOrderPolicy}cancel(){this.fold.cancel(),this.reorder.cancel()}apply(e,t,s){this.reorder.apply(e,t,s),this.fold.apply(e,this.naturalOrderPolicy)}}},{"../../policies/NodeIndexOrderPolicy":12,"../Fold":14,"../ReorderItems":19}],25:[function(e,t,s){"use strict";Object.defineProperty(s,"__esModule",{value:!0});const i=e("./ItemClicksAnalyser"),r=e("./PageVisitsAnalyser");s.DataAnalyser=class{constructor(e){this.itemClicksAnalyser=new i.ItemClicksAnalyser(e),this.pageVisitsAnalyser=new r.PageVisitsAnalyser(e)}getItemClickAnalysis(){return this.itemClicksAnalyser.getAnalysis()}getPageVisitsAnalysis(){return this.pageVisitsAnalyser.getAnalysis()}}},{"./ItemClicksAnalyser":30,"./PageVisitsAnalyser":31}],26:[function(e,t,s){"use strict";Object.defineProperty(s,"__esModule",{value:!0});s.DataAnalyserModule=class{constructor(e){this.database=e,this.cachedAnalysis=null,this.cachedAnalysisContentRevision=0}needsAnalysisUpdate(){return null===this.cachedAnalysis||this.cachedAnalysisContentRevision!==this.database.getCurrentRevision()}updateContentRevision(){this.cachedAnalysisContentRevision=this.database.getCurrentRevision()}makeAnalysisDeepCopy(e){return JSON.parse(JSON.stringify(e))}getAnalysis(){return this.needsAnalysisUpdate()&&(this.updateContentRevision(),this.cachedAnalysis=this.computeAnalysis()),this.makeAnalysisDeepCopy(this.cachedAnalysis)}}},{}],27:[function(e,t,s){(function(t){"use strict";Object.defineProperty(s,"__esModule",{value:!0});const i="undefined"!=typeof window?window.jQuery:void 0!==t?t.jQuery:null,r=e("../Utilities");s.DataLogger=class{constructor(e,t){this.database=e,this.pageLoadTimestamp=Date.now(),this.itemClickCallbacks=new Map,this.init(t)}init(e){this.startListeningForAllMenusItemClicks(e),this.startListeningForPageBeforeUnload()}startListeningForItemClicks(e){let t=this;for(let s of e){let e=e=>{t.onMenuItemClick(e,s)};this.itemClickCallbacks.set(s.id,e),s.node.on("click",e)}}stopListeningForItemClicks(e){for(let t of e){let e=this.itemClickCallbacks.get(t.id);this.itemClickCallbacks.delete(t.id),t.node.off("click",e)}}startListeningForMenuItemClicks(e){let t=e.getAllItems();this.startListeningForItemClicks(t)}stopListeningForMenuItemClicks(e){let t=e.getAllItems();this.stopListeningForItemClicks(t)}startListeningForAllMenusItemClicks(e){let t=e.getAllItems();this.startListeningForItemClicks(t)}stopListeningForAllMenusItemClicks(e){let t=e.getAllItems();this.stopListeningForItemClicks(t)}onMenuItemClick(e,t){this.database.logItemClick({itemID:t.id,groupID:t.parent.id,menuID:t.parent.parent.id,timestamp:e.timeStamp,pageID:r.Utilities.getCurrentPageID()})}startListeningForPageBeforeUnload(){let e=this;i(window).on("beforeunload",t=>{e.onPageBeforeUnload(t)})}onPageBeforeUnload(e){this.database.logPageVisit({timestamp:this.pageLoadTimestamp,pageID:r.Utilities.getCurrentPageID(),duration:e.timeStamp})}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../Utilities":2}],28:[function(e,t,s){"use strict";Object.defineProperty(s,"__esModule",{value:!0});const i=e("./Database"),r=e("./DataLogger"),o=e("./DataAnalyser");s.DataManager=class{constructor(e){this.database=new i.Database,this.logger=new r.DataLogger(this.database,e),this.analyser=new o.DataAnalyser(this.database),console.log("ITEM CLICK ANALYSIS",this.analyser.getItemClickAnalysis()),console.log("PAGE VISITS ANALYSIS",this.analyser.getPageVisitsAnalysis())}}},{"./DataAnalyser":25,"./DataLogger":27,"./Database":29}],29:[function(e,t,s){(function(t){"use strict";Object.defineProperty(s,"__esModule",{value:!0});const i="undefined"!=typeof window?window.jQuery:void 0!==t?t.jQuery:null,r=e("../Utilities");class o{constructor(){this.init(),this.startListeningForPageUnload(),console.log("Database loaded:",this)}init(){this.setContentToDefault(),this.isLocalStorageDataAvailable()&&this.loadFromLocalStorage()}setContentToDefault(){this.tables={itemClicks:{currentIndex:0,entries:[]},pageVisits:{currentIndex:0,entries:[]}},this.persistentStorage={},this.currentRevision=0}empty(){this.setContentToDefault(),this.clearLocalStorageData()}getCurrentRevision(){return this.currentRevision}isRevisionUpToDate(e){return this.currentRevision===e}getItemClickLogs(){return this.tables.itemClicks.entries}getItemClickLogsCurrentIndex(){return this.tables.itemClicks.currentIndex}logItemClick(e){let t=Object.assign(e,{index:this.tables.itemClicks.currentIndex});return this.tables.itemClicks.entries.push(t),this.tables.itemClicks.currentIndex+=1,this.currentRevision+=1,this.currentRevision}getPageVisitLogs(){return this.tables.pageVisits.entries}getPageVisitLogsCurrentIndex(){return this.tables.pageVisits.currentIndex}logPageVisit(e){let t=Object.assign(e,{index:this.tables.pageVisits.currentIndex});return this.tables.pageVisits.entries.push(t),this.tables.pageVisits.currentIndex+=1,this.currentRevision+=1,this.currentRevision}packDataToJSON(){let e={tables:this.tables,persistentStorage:this.persistentStorage,currentRevision:this.currentRevision};return JSON.stringify(e)}unpackDataFromJSON(e){let t=JSON.parse(e);function s(e,t){return void 0!==e?e:t}this.tables=s(t.tables,this.tables),this.persistentStorage=s(t.persistentStorage,this.persistentStorage),this.currentRevision=s(t.currentRevision,this.currentRevision)}isLocalStorageDataAvailable(){return r.Utilities.isLocalStorageAvailable()&&null!==window.localStorage.getItem(o.LOCAL_STORAGE_KEY)}saveInLocalStorage(){if(!r.Utilities.isLocalStorageAvailable())return;let e=this.packDataToJSON();window.localStorage.setItem(o.LOCAL_STORAGE_KEY,e)}loadFromLocalStorage(){if(!r.Utilities.isLocalStorageAvailable())return;let e=window.localStorage.getItem(o.LOCAL_STORAGE_KEY);this.unpackDataFromJSON(e)}clearLocalStorageData(){r.Utilities.isLocalStorageAvailable()&&window.localStorage.removeItem(o.LOCAL_STORAGE_KEY)}startListeningForPageUnload(){i(window).on("unload",e=>{this.onPageUnload()})}onPageUnload(){this.saveInLocalStorage()}}o.LOCAL_STORAGE_KEY="sam-data",s.Database=o}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../Utilities":2}],30:[function(e,t,s){"use strict";Object.defineProperty(s,"__esModule",{value:!0});const i=e("../Utilities"),r=e("./DataAnalyserModule");s.ItemClicksAnalyser=class extends r.DataAnalyserModule{constructor(e){super(e)}createItemClickAnalysis(){return{totalNbClicks:0,totalLocalNbClicks:0,itemStats:new Map,groupStats:new Map,currentEventIndex:this.database.getItemClickLogsCurrentIndex()}}createItemStats(){return{nbClicks:0,localNbClicks:0,clickFrequency:0,localClickFrequency:0,eventIndices:[],sourcePageIDs:[],timestamps:[]}}createItemGroupStats(){return{nbClicks:0,localNbClicks:0,clickFrequency:0,localClickFrequency:0,eventIndices:[],sourcePageIDs:[],timestamps:[]}}makeAnalysisDeepCopy(e){return{totalNbClicks:e.totalNbClicks,totalLocalNbClicks:e.totalLocalNbClicks,itemStats:new Map(e.itemStats),groupStats:new Map(e.groupStats),currentEventIndex:e.currentEventIndex}}updateItemStatsWithClick(e,t,s){let i=e.itemID;t.itemStats.has(i)||t.itemStats.set(i,this.createItemStats());let r=t.itemStats.get(i);r.nbClicks+=1,s&&(r.localNbClicks+=1),r.sourcePageIDs.push(e.pageID),r.timestamps.push(e.timestamp),r.eventIndices.push(e.index)}updateItemGroupStatsWithClick(e,t,s){let i=e.groupID;t.groupStats.has(i)||t.groupStats.set(i,this.createItemGroupStats());let r=t.groupStats.get(i);r.nbClicks+=1,s&&(r.localNbClicks+=1),r.sourcePageIDs.push(e.pageID),r.timestamps.push(e.timestamp),r.eventIndices.push(e.index)}processItemClickLog(e,t){let s=i.Utilities.getCurrentPageID(),r=e.pageID===s;t.totalNbClicks+=1,r&&(t.totalLocalNbClicks+=1),this.updateItemStatsWithClick(e,t,r),this.updateItemGroupStatsWithClick(e,t,r)}computeFrequencies(e){for(let t of e.itemStats.values())t.clickFrequency=t.nbClicks/e.totalNbClicks,t.localClickFrequency=t.localNbClicks/e.totalLocalNbClicks}computeAnalysis(){let e=this.database.getItemClickLogs(),t=this.createItemClickAnalysis();for(let s of e)this.processItemClickLog(s,t);return this.computeFrequencies(t),t}static splitItemsByStatsAvailability(e,t){let s=[],i=[];for(let r of e){let e=r.id;t.itemStats.has(e)?s.push(r):i.push(r)}return{withStats:s,withoutStats:i}}static splitItemGroupsByStatsAvailability(e,t){let s=[],i=[];for(let r of e){let e=r.id;t.groupStats.has(e)?s.push(r):i.push(r)}return{withStats:s,withoutStats:i}}}},{"../Utilities":2,"./DataAnalyserModule":26}],31:[function(e,t,s){"use strict";Object.defineProperty(s,"__esModule",{value:!0});const i=e("./DataAnalyserModule");s.PageVisitsAnalyser=class extends i.DataAnalyserModule{constructor(e){super(e)}createPageVisitsAnalysis(){return{totalNbVisits:0,nbUniquePages:0,pageStats:new Map,currentEventIndex:this.database.getItemClickLogsCurrentIndex()}}createPageStats(){return{nbVisits:0,visitFrequency:0,timestamps:[],firstVisitTimestamp:Number.MAX_SAFE_INTEGER,lastVisitTimestamp:0,visitDurations:[],totalVisitDuration:0,eventIndices:[]}}makeAnalysisDeepCopy(e){return{totalNbVisits:e.totalNbVisits,nbUniquePages:e.nbUniquePages,pageStats:new Map(e.pageStats),currentEventIndex:e.currentEventIndex}}processPageVisitLog(e,t){let s=e.pageID,i=t.pageStats.has(s);t.totalNbVisits+=1,i||(t.nbUniquePages+=1),i||t.pageStats.set(s,this.createPageStats());let r=t.pageStats.get(s);r.nbVisits+=1;let o=e.timestamp;r.timestamps.push(o),r.firstVisitTimestamp=Math.min(o,r.firstVisitTimestamp),r.lastVisitTimestamp=Math.max(o,r.lastVisitTimestamp);let n=e.duration;r.visitDurations.push(n),r.totalVisitDuration+=n,r.eventIndices.push(e.index)}computeFrequencies(e){for(let t of e.pageStats.values())t.visitFrequency=t.nbVisits/e.totalNbVisits}computeAnalysis(){let e=this.database.getPageVisitLogs(),t=this.createPageVisitsAnalysis();for(let s of e)this.processPageVisitLog(s,t);return this.computeFrequencies(t),t}}},{"./DataAnalyserModule":26}],32:[function(e,t,s){(function(e){"use strict";Object.defineProperty(s,"__esModule",{value:!0});const t="undefined"!=typeof window?window.jQuery:void 0!==e?e.jQuery:null;s.NO_SELECTOR=Symbol("No selector"),s.isSelector=function(e){let s=t.type(e);return"object"===s?e instanceof jQuery||e instanceof Element:"string"===s};class i{constructor(e,t=s.NO_SELECTOR,i=null){this.node=e,this.selector=t,this.parent=i,this.id=this.getID(),this.tagWithType()}tag(e,t){this.node.attr(i.TAG_PREFIX+e,t)}getTag(e){return i.getNodeTag(this.node,e)}tagWithType(){this.tag("type",this.getType())}getSelector(){return i.nodeToSelector(this.node)}getID(){return this.getType()+"/"+this.getSelector()}static getNodeTag(e,t){return e.attr(i.TAG_PREFIX+t)}static nodeToSelector(e){if(!e||0===e.length)return"";if(e.is("body")||e.is("html"))return e.prop("tagName");let t=e.attr("id");if(t&&t.length>0)return`#${t}`;let s=e.prop("tagName"),r=e.index();return i.nodeToSelector(e.parent())+` > ${s}:eq(${r})`}}i.TAG_PREFIX="data-sam-",s.AdaptiveElement=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],33:[function(e,t,s){(function(t){"use strict";Object.defineProperty(s,"__esModule",{value:!0});const i="undefined"!=typeof window?window.jQuery:void 0!==t?t.jQuery:null,r=e("./AdaptiveElement"),o=e("../Utilities"),n=e("../adaptations/styles/Reorder");class a extends r.AdaptiveElement{constructor(e,t,s){super(e,t,s),this.canBeReordered=!0,e.hasClass(n.Reorder.NON_REORDERABLE_ELEMENT_CLASS)&&(this.canBeReordered=!1)}getType(){return a.ELEMENT_TYPE}findLinkNodes(e){let t=this.node.find("a");return this.node.is("a")&&(t=t.add(this.node)),void 0!==e&&(t=t.filter((t,s)=>{let r=i(s).attr("href");return o.Utilities.isLinkMatchingPageID(r,e)})),t}static splitAllByGroup(e){let t=new Map;for(let s of e){let e=s.parent;t.has(e)?t.get(e).push(s):t.set(e,[s])}return[...t.values()]}static fromSelector(e,t){let s=t.node.find(e);return new a(s,e,t)}}a.HTML_CLASS="sam-item",a.ELEMENT_TYPE="item",s.Item=a}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../Utilities":2,"../adaptations/styles/Reorder":17,"./AdaptiveElement":32}],34:[function(e,t,s){"use strict";Object.defineProperty(s,"__esModule",{value:!0});const i=e("./AdaptiveElement"),r=e("./Item"),o=e("../adaptations/styles/Reorder");class n extends i.AdaptiveElement{constructor(e,t,s,i=[]){super(e,t,s),this.items=i,this.canBeReordered=!0,e.hasClass(o.Reorder.NON_REORDERABLE_ELEMENT_CLASS)&&(this.canBeReordered=!1)}getType(){return n.ELEMENT_TYPE}fillUsingItemSelector(e){let t=this;this.node.find(e).each((e,s)=>{t.items.push(r.Item.fromSelector($(s),t))}),this.updateItemsReorderingConstraints()}isAlphabeticallySorted(){let e=this.items.map(e=>e.node.text()),t=e.length;const s={usage:"sort",sensitivity:"base",ignorePunctuation:!0,numeric:!0};return e.every((i,r)=>r===t-1||i.localeCompare(e[r+1],s)<0)}updateItemsReorderingConstraints(){let e=!this.isAlphabeticallySorted();for(let t of this.items)t.canBeReordered=!!t.canBeReordered&&e}static fromSelectors(e,t,s){let r=e===i.NO_SELECTOR?s.node:s.node.find(e),o=new n(r,e,s);return o.fillUsingItemSelector(t),o}}n.HTML_CLASS="sam-group",n.ELEMENT_TYPE="group",s.ItemGroup=n},{"../adaptations/styles/Reorder":17,"./AdaptiveElement":32,"./Item":33}],35:[function(e,t,s){(function(t){"use strict";Object.defineProperty(s,"__esModule",{value:!0});const i="undefined"!=typeof window?window.jQuery:void 0!==t?t.jQuery:null,r=e("./AdaptiveElement"),o=e("./ItemGroup");class n extends r.AdaptiveElement{constructor(e,t,s=[]){super(e,t),this.groups=s}getType(){return n.ELEMENT_TYPE}getAllItems(){let e=[];for(let t of this.groups)e=e.concat(t.items);return e}getAllItemNodes(){return this.getAllItems().map(e=>e.node)}fillUsingGenericItemSelector(e){this.groups.push(o.ItemGroup.fromSelectors(r.NO_SELECTOR,e,this))}fillUsingGenericGroupAndItemSelectors(e,t){(this.node.is(e)?this.node:this.node.find(e)).each((e,s)=>{this.groups.push(o.ItemGroup.fromSelectors(i(s),t,this))})}fillUsingSpecificGroupSelectors(e){for(let t in e)if(e.hasOwnProperty(t)){let s=e[t];this.groups.push(o.ItemGroup.fromSelectors(i(t),s,this))}}static getAllMenusItems(e){let t=[];for(let s of e)t=t.concat(s.getAllItems());return t}static getAllMenusGroups(e){let t=[];for(let s of e)t=t.concat(s.groups);return t}static fromSelectors(e,t,s){let o=i(e),a=new n(o,e);return void 0===s?r.isSelector(t)?a.fillUsingGenericItemSelector(t):a.fillUsingSpecificGroupSelectors(t):a.fillUsingGenericGroupAndItemSelectors(t,s),a}}n.HTML_CLASS="sam-menu",n.ELEMENT_TYPE="menu",s.Menu=n}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./AdaptiveElement":32,"./ItemGroup":34}],36:[function(e,t,s){"use strict";Object.defineProperty(s,"__esModule",{value:!0});const i=e("./Menu"),r=e("./AdaptiveElement");class o{constructor(e=[]){this.menus=e}getAllItems(){return i.Menu.getAllMenusItems(this.menus)}getNbItems(){return this.getAllItems().length}getAllGroups(){return i.Menu.getAllMenusGroups(this.menus)}getNbGroups(){return this.getAllGroups().length}getAllMenus(){return this.menus}getNbMenus(){return this.getAllMenus().length}addMenu(e){this.menus.push(e)}removeMenu(e){let t=this.menus.findIndex(t=>t.id===e);return-1===t?null:this.menus.splice(t,1)[0]}static fromGenericMenuAndItemSelectors(e,t){let s=[];return $(e).each((e,r)=>{s.push(i.Menu.fromSelectors($(r),t))}),new o(s)}static fromGenericMenuGroupAndItemSelectors(e,t,s){let r=[];return $(e).each((e,o)=>{r.push(i.Menu.fromSelectors($(o),t,s))}),new o(r)}static fromSpecificSelectors(e){let t=[];for(let s in e)if(e.hasOwnProperty(s)){let o=e[s];r.isSelector(o)?t.push(i.Menu.fromSelectors($(s),o)):(o=o,t.push(i.Menu.fromSelectors($(s),o)))}return new o(t)}}s.MenuManager=o},{"./AdaptiveElement":32,"./Menu":35}],37:[function(e,t,s){"use strict";Object.defineProperty(s,"__esModule",{value:!0});const i=e("./SelfAdaptingMenus");window.SAM=i.SelfAdaptingMenus},{"./SelfAdaptingMenus":1}]},{},[37]);