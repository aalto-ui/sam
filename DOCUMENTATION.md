# Documentation of SAM

This document aims at presenting the global architecture and logic of SAM, along with some more specific tutorials covering important topics.
It naturally complements the formal documentation of the different objets available in SAM.




## Structure of the project
SAM follows a rather classical project structure for JavaScript libraries using npm and git. In case your are not familiar with this type of structure, it is briefly described by the two following tables. The _Remote_ column indicate whether it should be pushed to the remote repository or not.


| Directory      | Description                                                                 | Remote |
|----------------|-----------------------------------------------------------------------------|--------|
| `build`        | Contains the build of the library.                                          | No.    |
| `doc`          | Contains the documentation generated by Typedoc.                            | No.    |
| `examples`     | Contains initialisation scripts for real webpages along with test webpages. | Yes.   |
| `node_modules` | Contains the dependencies managed by npm.                                   | No.    |
| `src`          | Contains the sources. One subdirectory per language.                        | Yes.   |

| File               | Description                                                        | Remote |
|--------------------|--------------------------------------------------------------------|--------|
| `DOCUMENTATION.md` | The current file.                                                  | Yes.   |
| `Gruntile.js`      | Configuration file of Grunt (the build system of SAM).             | Yes.   |
| `package.json`     | The description of the project and its dependencies for npm.       | Yes.   |
| `README.md`        | The document to display on the frontpage of the project on Github. | Yes.   |
| `tsconfig.json`    | Configuration file of tsc (the TypeScript compiler).               | Yes.   |




## SAM pipeline 
The logic of SAM is split in three complementary modules, which are used one after another in the adaptation pipeline. The following figure illustrates how do they relate to each other in the library pipeline.

![SAM pipeline](misc/sam-pipeline.svg)

* The **Menu abstraction** module is responsible for creating an abstract representation of the menus to adapt in a webpage, given jQuery selectors which target the DOM elements which constitute the menus.
* The **User logging** module is responsible for loading (on page load), recordering, turning into convenient metrics and saving (on page exit) some of the interactions between the user and the webpage.
* The **Menu adaptation** module is responsible for modifying the DOM to adapt the abstracted menus, given the history of interactions recorded by the User logging module.

When an instance of SAM is created, the given selectors are used to fetch the elements they target in the DOM, in order to build an abstraction of the menus to adapt. If no selector is provided, or if they do not target any element, then SAM is initialised without any menu to adapt (they can be manually added at a later time).

Immediately after that, the previous history of interactions is loaded into a database, and the interaction logger starts recording certains events on the page (such as clicks on menu items).

The actual adaptation process only start at that point.
First, the selected target policy first sort all the items (or groups of items) by giving them scores according to a certain metric.
Then, the selected adaptation style makes certain changes to the DOM of the webpage to adapt the menu in accordance with the ranking made by the policy. 

Apart from user interaction logging (or a manual update of the adaptation), nothing happens until the page is about to be left. At that moment, the content of the database is saved, in order to make the newly recorded events available to SAM during future visits of the same website.

## Menu abstraction

## User logging

## Menu adaptation



# Tutorials

## How to initialise SAM

## How to control the adaptation

## How to add a new style or policy

